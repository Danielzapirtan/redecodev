<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Room Designer & Gemini Prompt Engineer</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Courier New', monospace;
        }
        
        body {
            background-color: #0f172a;
            color: #e2e8f0;
            padding: 20px;
            min-height: 100vh;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: 400px 1fr 400px;
            gap: 20px;
            height: calc(100vh - 40px);
        }
        
        .panel {
            background-color: #1e293b;
            border: 1px solid #334155;
            border-radius: 6px;
            padding: 15px;
            overflow-y: auto;
        }
        
        .panel-header {
            font-size: 14px;
            font-weight: bold;
            color: #60a5fa;
            margin-bottom: 15px;
            padding-bottom: 8px;
            border-bottom: 1px solid #334155;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .room-canvas {
            background-color: #111827;
            border: 1px solid #334155;
            position: relative;
            overflow: hidden;
        }
        
        .grid {
            position: absolute;
            width: 100%;
            height: 100%;
            background-image: 
                linear-gradient(rgba(30, 41, 59, 0.3) 1px, transparent 1px),
                linear-gradient(90deg, rgba(30, 41, 59, 0.3) 1px, transparent 1px);
            background-size: 40px 40px;
        }
        
        .furniture {
            position: absolute;
            border: 1px solid;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: move;
            user-select: none;
            font-size: 11px;
            overflow: hidden;
        }
        
        .furniture.selected {
            border-width: 2px;
            border-style: dashed;
        }
        
        .control-group {
            margin-bottom: 20px;
        }
        
        .command-line {
            background-color: #111827;
            border: 1px solid #334155;
            padding: 10px;
            font-family: 'Courier New', monospace;
            font-size: 13px;
            color: #e2e8f0;
            width: 100%;
            resize: vertical;
            min-height: 100px;
        }
        
        .btn {
            background-color: #3b82f6;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 13px;
            font-weight: bold;
            margin-right: 8px;
            margin-bottom: 8px;
        }
        
        .btn:hover {
            background-color: #2563eb;
        }
        
        .btn-secondary {
            background-color: #475569;
        }
        
        .btn-secondary:hover {
            background-color: #334155;
        }
        
        .btn-success {
            background-color: #10b981;
        }
        
        .btn-success:hover {
            background-color: #059669;
        }
        
        .input-group {
            margin-bottom: 12px;
        }
        
        label {
            display: block;
            font-size: 12px;
            margin-bottom: 5px;
            color: #94a3b8;
        }
        
        input, select, textarea {
            background-color: #111827;
            border: 1px solid #334155;
            color: #e2e8f0;
            padding: 8px;
            width: 100%;
            border-radius: 4px;
            font-size: 13px;
        }
        
        .furniture-list {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-bottom: 15px;
        }
        
        .furniture-item {
            background-color: #334155;
            padding: 8px 12px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
            text-align: center;
            min-width: 70px;
        }
        
        .furniture-item:hover {
            background-color: #475569;
        }
        
        .log {
            background-color: #111827;
            border: 1px solid #334155;
            padding: 10px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            color: #e2e8f0;
            height: 200px;
            overflow-y: auto;
            margin-top: 15px;
        }
        
        .log-entry {
            margin-bottom: 5px;
            padding: 3px 0;
            border-bottom: 1px solid rgba(51, 65, 85, 0.3);
        }
        
        .log-cmd {
            color: #60a5fa;
        }
        
        .log-info {
            color: #e2e8f0;
        }
        
        .log-success {
            color: #10b981;
        }
        
        .log-error {
            color: #ef4444;
        }
        
        .status-bar {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background-color: rgba(15, 23, 42, 0.9);
            padding: 8px 15px;
            font-size: 12px;
            border-top: 1px solid #334155;
            display: flex;
            justify-content: space-between;
        }
        
        .help-text {
            font-size: 11px;
            color: #94a3b8;
            margin-top: 5px;
            line-height: 1.4;
        }
        
        .prompt-output {
            background-color: #111827;
            border: 1px solid #334155;
            padding: 15px;
            font-family: 'Courier New', monospace;
            font-size: 13px;
            color: #e2e8f0;
            height: 300px;
            overflow-y: auto;
            white-space: pre-wrap;
            margin-top: 15px;
            line-height: 1.4;
        }
        
        .dimension-display {
            position: absolute;
            background-color: rgba(15, 23, 42, 0.8);
            padding: 2px 6px;
            font-size: 10px;
            border-radius: 2px;
            pointer-events: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Left Panel: Controls & Furniture -->
        <div class="panel">
            <div class="panel-header">Controls & Furniture</div>
            
            <div class="control-group">
                <div class="input-group">
                    <label for="roomWidth">Room Width (grid units)</label>
                    <input type="number" id="roomWidth" value="20" min="5" max="50">
                </div>
                
                <div class="input-group">
                    <label for="roomHeight">Room Height (grid units)</label>
                    <input type="number" id="roomHeight" value="15" min="5" max="50">
                </div>
                
                <button class="btn" id="resizeRoom">Resize Room</button>
                <button class="btn btn-secondary" id="clearRoom">Clear All</button>
            </div>
            
            <div class="control-group">
                <div class="panel-header">Furniture Library</div>
                <div class="furniture-list" id="furnitureLibrary">
                    <div class="furniture-item" data-type="sofa" data-width="4" data-height="2">Sofa</div>
                    <div class="furniture-item" data-type="table" data-width="3" data-height="3">Table</div>
                    <div class="furniture-item" data-type="bed" data-width="4" data-height="5">Bed</div>
                    <div class="furniture-item" data-type="chair" data-width="1" data-height="1">Chair</div>
                    <div class="furniture-item" data-type="desk" data-width="3" data-height="2">Desk</div>
                    <div class="furniture-item" data-type="bookshelf" data-width="2" data-height="4">Bookshelf</div>
                    <div class="furniture-item" data-type="lamp" data-width="1" data-height="1">Lamp</div>
                    <div class="furniture-item" data-type="tv" data-width="3" data-height="2">TV Stand</div>
                    <div class="furniture-item" data-type="rug" data-width="5" data-height="4">Rug</div>
                    <div class="furniture-item" data-type="plant" data-width="1" data-height="1">Plant</div>
                </div>
                
                <div class="input-group">
                    <label for="customFurniture">Custom Furniture</label>
                    <input type="text" id="customFurniture" placeholder="Enter furniture name">
                </div>
                
                <div class="input-group">
                    <label for="customWidth">Width (grid units)</label>
                    <input type="number" id="customWidth" value="2" min="1" max="10">
                </div>
                
                <div class="input-group">
                    <label for="customHeight">Height (grid units)</label>
                    <input type="number" id="customHeight" value="2" min="1" max="10">
                </div>
                
                <button class="btn" id="addCustom">Add Custom Furniture</button>
            </div>
            
            <div class="control-group">
                <div class="panel-header">CLI Commands</div>
                <textarea class="command-line" id="commandInput" placeholder="Enter commands here (one per line). Type 'help' for command list.">help</textarea>
                <button class="btn" id="executeCommands">Execute Commands</button>
                <button class="btn btn-secondary" id="clearCommands">Clear</button>
                
                <div class="log">
                    <div class="log-entry log-info">Room Designer CLI v1.0</div>
                    <div class="log-entry log-info">Type 'help' for command list</div>
                </div>
            </div>
        </div>
        
        <!-- Center Panel: Room Canvas -->
        <div class="panel" style="padding: 0; position: relative;">
            <div class="room-canvas" id="roomCanvas">
                <div class="grid" id="grid"></div>
                <!-- Furniture will be added here dynamically -->
            </div>
            
            <div class="status-bar">
                <div>Room: 20Ã—15 | Furniture: 0 | Selected: None</div>
                <div>Grid: 40px | X: 0, Y: 0</div>
            </div>
        </div>
        
        <!-- Right Panel: Prompt Engineering -->
        <div class="panel">
            <div class="panel-header">Gemini Prompt Engineering</div>
            
            <div class="control-group">
                <div class="input-group">
                    <label for="roomStyle">Room Style</label>
                    <select id="roomStyle">
                        <option value="modern">Modern</option>
                        <option value="minimalist">Minimalist</option>
                        <option value="traditional">Traditional</option>
                        <option value="industrial">Industrial</option>
                        <option value="scandinavian">Scandinavian</option>
                        <option value="bohemian">Bohemian</option>
                        <option value="rustic">Rustic</option>
                        <option value="contemporary">Contemporary</option>
                    </select>
                </div>
                
                <div class="input-group">
                    <label for="lighting">Lighting</label>
                    <select id="lighting">
                        <option value="natural daylight">Natural Daylight</option>
                        <option value="warm interior lighting">Warm Interior Lighting</option>
                        <option value="studio lighting">Studio Lighting</option>
                        <option value="evening lighting">Evening Lighting</option>
                        <option value="moody lighting">Moody Lighting</option>
                    </select>
                </div>
                
                <div class="input-group">
                    <label for="cameraAngle">Camera Angle</label>
                    <select id="cameraAngle">
                        <option value="wide angle from corner">Wide Angle from Corner</option>
                        <option value="eye level">Eye Level</option>
                        <option value="top down">Top Down</option>
                        <option value="close up on seating area">Close Up on Seating Area</option>
                    </select>
                </div>
                
                <div class="input-group">
                    <label for="additionalDetails">Additional Details</label>
                    <textarea id="additionalDetails" rows="3" placeholder="Add any additional details for the scene..."></textarea>
                </div>
                
                <button class="btn btn-success" id="generatePrompt">Generate Gemini Prompt</button>
                <button class="btn" id="copyPrompt">Copy to Clipboard</button>
            </div>
            
            <div class="panel-header">Generated Prompt</div>
            <div class="prompt-output" id="promptOutput">
                // Prompt will appear here
                // 1. Generate a prompt using the button above
                // 2. Copy it to use with Google Gemini
                // 3. The prompt will create a realistic 3D view of your room
            </div>
            
            <div class="control-group">
                <div class="panel-header">Prompt Templates</div>
                <button class="btn btn-secondary" data-template="photorealistic">Photorealistic</button>
                <button class="btn btn-secondary" data-template="archviz">Architectural Visualization</button>
                <button class="btn btn-secondary" data-template="sketch">Design Sketch</button>
                <button class="btn btn-secondary" data-template="detailed">Detailed Description</button>
                
                <div class="help-text">
                    Use these templates as starting points for different styles of 3D visualization prompts.
                </div>
            </div>
        </div>
    </div>

    <script>
        // Room Designer Application
        class RoomDesigner {
            constructor() {
                this.roomWidth = 20;
                this.roomHeight = 15;
                this.gridSize = 40;
                this.furniture = [];
                this.selectedFurniture = null;
                this.dragging = false;
                this.dragOffset = { x: 0, y: 0 };
                this.commandHistory = [];
                
                this.init();
            }
            
            init() {
                this.canvas = document.getElementById('roomCanvas');
                this.grid = document.getElementById('grid');
                this.statusBar = this.canvas.querySelector('.status-bar');
                
                this.setupEventListeners();
                this.resizeRoom();
                this.updateStatus();
                this.setupCLI();
                this.setupPromptEngineer();
            }
            
            setupEventListeners() {
                // Room controls
                document.getElementById('resizeRoom').addEventListener('click', () => this.resizeRoom());
                document.getElementById('clearRoom').addEventListener('click', () => this.clearRoom());
                
                // Furniture library
                document.querySelectorAll('.furniture-item').forEach(item => {
                    item.addEventListener('click', (e) => {
                        const type = e.target.getAttribute('data-type');
                        const width = parseInt(e.target.getAttribute('data-width'));
                        const height = parseInt(e.target.getAttribute('data-height'));
                        this.addFurniture(type, width, height);
                    });
                });
                
                // Custom furniture
                document.getElementById('addCustom').addEventListener('click', () => {
                    const type = document.getElementById('customFurniture').value || 'custom';
                    const width = parseInt(document.getElementById('customWidth').value);
                    const height = parseInt(document.getElementById('customHeight').value);
                    if (type && width > 0 && height > 0) {
                        this.addFurniture(type, width, height);
                    }
                });
                
                // Canvas interactions
                this.canvas.addEventListener('mousedown', (e) => this.handleCanvasMouseDown(e));
                this.canvas.addEventListener('mousemove', (e) => this.handleCanvasMouseMove(e));
                this.canvas.addEventListener('mouseup', () => this.handleCanvasMouseUp());
                this.canvas.addEventListener('click', (e) => {
                    if (!this.dragging) {
                        this.handleCanvasClick(e);
                    }
                });
                
                // CLI commands
                document.getElementById('executeCommands').addEventListener('click', () => this.executeCLICommands());
                document.getElementById('clearCommands').addEventListener('click', () => {
                    document.getElementById('commandInput').value = '';
                });
                
                // Keyboard shortcuts
                document.addEventListener('keydown', (e) => {
                    if (e.target.tagName === 'TEXTAREA' || e.target.tagName === 'INPUT') return;
                    
                    if (e.key === 'Delete' || e.key === 'Backspace') {
                        this.deleteSelectedFurniture();
                    } else if (e.key === 'Escape') {
                        this.deselectFurniture();
                    } else if (e.key === 'ArrowUp' && this.selectedFurniture) {
                        this.moveSelectedFurniture(0, -1);
                        e.preventDefault();
                    } else if (e.key === 'ArrowDown' && this.selectedFurniture) {
                        this.moveSelectedFurniture(0, 1);
                        e.preventDefault();
                    } else if (e.key === 'ArrowLeft' && this.selectedFurniture) {
                        this.moveSelectedFurniture(-1, 0);
                        e.preventDefault();
                    } else if (e.key === 'ArrowRight' && this.selectedFurniture) {
                        this.moveSelectedFurniture(1, 0);
                        e.preventDefault();
                    }
                });
            }

            setupCLI() {
                // Bind methods to this instance to maintain proper context
                this.cliCommands = {
                    help: (args) => {
                        this.cliOutput(`
            Available commands:
            - help: Show this help
            - clear: Clear all furniture
            - resize <width> <height>: Resize room
            - add <type> <width> <height>: Add furniture
            - list: List all furniture
            - select <id>: Select furniture by ID
            - delete: Delete selected furniture
            - move <x> <y>: Move selected furniture
            - roominfo: Show room information
            - save: Save room layout (console)
            - load: Load room layout (console)
                        `, 'info');
                    },
                    clear: (args) => {
                        this.clearRoom();
                        this.cliOutput('Room cleared', 'success');
                    },
                    resize: (args) => {
                        if (args && args.length >= 2) {
                            this.roomWidth = parseInt(args[0]);
                            this.roomHeight = parseInt(args[1]);
                            document.getElementById('roomWidth').value = this.roomWidth;
                            document.getElementById('roomHeight').value = this.roomHeight;
                            this.resizeRoom();
                            this.cliOutput(`Room resized to ${this.roomWidth}x${this.roomHeight}`, 'success');
                        } else {
                            this.cliOutput('Usage: resize <width> <height>', 'error');
                        }
                    },
                    add: (args) => {
                        if (args && args.length >= 3) {
                            const type = args[0];
                            const width = parseInt(args[1]);
                            const height = parseInt(args[2]);
                            this.addFurniture(type, width, height);
                            this.cliOutput(`Added ${type} (${width}x${height})`, 'success');
                        } else {
                            this.cliOutput('Usage: add <type> <width> <height>', 'error');
                        }
                    },
                    list: (args) => {
                        if (this.furniture.length === 0) {
                            this.cliOutput('No furniture in room', 'info');
                            return;
                        }
                        
                        let output = 'Furniture in room:\n';
                        this.furniture.forEach((f, i) => {
                            output += `[${i}] ${f.type} at (${f.x},${f.y}) size ${f.width}x${f.height}\n`;
                        });
                        this.cliOutput(output, 'info');
                    },
                    select: (args) => {
                        if (args && args.length >= 1) {
                            const id = parseInt(args[0]);
                            if (id >= 0 && id < this.furniture.length) {
                                this.selectFurniture(this.furniture[id]);
                                this.cliOutput(`Selected furniture ${id}: ${this.furniture[id].type}`, 'success');
                            } else {
                                this.cliOutput(`Invalid furniture ID: ${id}`, 'error');
                            }
                        } else {
                            this.cliOutput('Usage: select <id>', 'error');
                        }
                    },
                    delete: (args) => {
                        if (this.selectedFurniture) {
                            const type = this.selectedFurniture.type;
                            this.deleteSelectedFurniture();
                            this.cliOutput(`Deleted ${type}`, 'success');
                        } else {
                            this.cliOutput('No furniture selected', 'error');
                        }
                    },
                    move: (args) => {
                        if (args && args.length >= 2 && this.selectedFurniture) {
                            const newX = parseInt(args[0]);
                            const newY = parseInt(args[1]);
                            const dx = newX - this.selectedFurniture.x;
                            const dy = newY - this.selectedFurniture.y;
                            this.moveSelectedFurniture(dx, dy);
                            this.cliOutput(`Moved to (${this.selectedFurniture.x},${this.selectedFurniture.y})`, 'success');
                        } else if (!this.selectedFurniture) {
                            this.cliOutput('No furniture selected', 'error');
                        } else {
                            this.cliOutput('Usage: move <x> <y>', 'error');
                        }
                    },
                    roominfo: (args) => {
                        this.cliOutput(`
            Room Information:
            - Dimensions: ${this.roomWidth} x ${this.roomHeight} grid units
            - Furniture count: ${this.furniture.length}
            - Grid size: ${this.gridSize}px per unit
            - Total area: ${this.roomWidth * this.roomHeight} grid units
                        `, 'info');
                    },
                    save: (args) => {
                        const layout = {
                            room: { width: this.roomWidth, height: this.roomHeight },
                            furniture: this.furniture
                        };
                        console.log('Room layout (copy this):');
                        console.log(JSON.stringify(layout, null, 2));
                        this.cliOutput('Layout saved to console. Copy the JSON output.', 'success');
                    },
                    load: (args) => {
                        this.cliOutput('To load a layout, use the browser console:\n1. Copy your layout JSON\n2. In console: roomDesigner.loadLayout(yourJson)\n3. Or: roomDesigner.furniture = yourJson.furniture; roomDesigner.renderFurniture();', 'info');
                    }
                };
            }
           
            cliOutput(message, type = 'info') {
                const log = document.querySelector('.log');
                const entry = document.createElement('div');
                entry.className = `log-entry log-${type}`;
                entry.innerHTML = `${message.trim()}`;
                log.appendChild(entry);
                log.scrollTop = log.scrollHeight;
            }
            
            // Prompt Engineering Functions
            generatePrompt() {
                const style = document.getElementById('roomStyle').value;
                const lighting = document.getElementById('lighting').value;
                const cameraAngle = document.getElementById('cameraAngle').value;
                const additionalDetails = document.getElementById('additionalDetails').value;
                
                // Create room description from furniture
                let roomDescription = `A ${style} style room with the following layout:\n`;
                roomDescription += `- Room dimensions: ${this.roomWidth} by ${this.roomHeight} grid units\n`;
                
                if (this.furniture.length === 0) {
                    roomDescription += "- The room is currently empty\n";
                } else {
                    roomDescription += "- Furniture arrangement:\n";
                    this.furniture.forEach(f => {
                        roomDescription += `  * A ${f.type} (${f.width}x${f.height} units) positioned at coordinates (${f.x}, ${f.y})\n`;
                    });
                }
                
                // Build the prompt
                let prompt = `Create a realistic, non-interactive 3D visualization of an interior room.\n\n`;
                prompt += `SCENE DESCRIPTION:\n${roomDescription}\n`;
                prompt += `STYLE AND SETTING:\n`;
                prompt += `- Architectural style: ${style}\n`;
                prompt += `- Lighting: ${lighting}\n`;
                prompt += `- Camera angle: ${cameraAngle}\n`;
                prompt += `- Render style: Photorealistic, architectural visualization quality\n`;
                prompt += `- Mood: Inviting, well-designed, attention to material textures\n\n`;
                
                prompt += `TECHNICAL SPECIFICATIONS:\n`;
                prompt += `- Output: Single high-quality image\n`;
                prompt += `- Aspect ratio: 16:9\n`;
                prompt += `- Resolution: 4K quality\n`;
                prompt += `- Level of detail: High, with accurate proportions and realistic materials\n`;
                prompt += `- Lighting: Global illumination, soft shadows, natural light falloff\n\n`;
                
                if (additionalDetails) {
                    prompt += `ADDITIONAL DETAILS:\n${additionalDetails}\n\n`;
                }
                
                prompt += `IMPORTANT NOTES:\n`;
                prompt += `- Ensure all furniture is to scale and properly positioned\n`;
                prompt += `- Pay attention to realistic material textures (wood, fabric, metal, etc.)\n`;
                prompt += `- Include appropriate decorative elements that match the ${style} style\n`;
                prompt += `- The image should look like a professional architectural visualization\n`;
                prompt += `- Focus on composition, lighting, and atmosphere\n`;
                
                document.getElementById('promptOutput').textContent = prompt;
            }
            
            copyPrompt() {
                const prompt = document.getElementById('promptOutput').textContent;
                navigator.clipboard.writeText(prompt).then(() => {
                    this.cliOutput('Prompt copied to clipboard!', 'success');
                });
            }
            
            applyPromptTemplate(template) {
                let prompt = '';
                
                switch(template) {
                    case 'photorealistic':
                        prompt = `Generate a photorealistic 3D rendering of the room described below. Use realistic materials, accurate lighting with soft shadows, and natural camera perspective. Focus on creating an image that looks like a professional architectural photograph with accurate scale, texture details, and atmospheric depth.`;
                        break;
                    case 'archviz':
                        prompt = `Create an architectural visualization of the room. Use clean lines, accurate perspective, and professional rendering techniques typical of architectural software. Include scale references, proper lighting studies, and material callouts. The result should look like a professional architect's presentation render.`;
                        break;
                    case 'sketch':
                        prompt = `Generate a design sketch or concept art of the room. Use loose, artistic lines, suggestive forms, and a creative interpretation. This should look like an architect's or designer's preliminary sketch with notes, measurements, and design ideas in the margins.`;
                        break;
                    case 'detailed':
                        prompt = `Create an extremely detailed description of the 3D scene for text-to-image generation. Include specifics about materials (type of wood, fabric weave, metal finish), lighting conditions (time of day, light temperature, shadow softness), camera settings (focal length, aperture), and atmospheric elements (dust particles, light rays, subtle imperfections).`;
                        break;
                }
                
                document.getElementById('additionalDetails').value = prompt;
                this.generatePrompt();
            }
            
            // Public method for loading layouts from console
            loadLayout(layout) {
                if (layout.room) {
                    this.roomWidth = layout.room.width;
                    this.roomHeight = layout.room.height;
                    document.getElementById('roomWidth').value = this.roomWidth;
                    document.getElementById('roomHeight').value = this.roomHeight;
                    this.resizeRoom();
                }
                
                if (layout.furniture) {
                    this.furniture = layout.furniture;
                    this.renderFurniture();
                    this.updateStatus();
                    this.cliOutput('Layout loaded successfully');
                }
            }
        }
        
        // Initialize the application
        const roomDesigner = new RoomDesigner();
        
        // Make accessible from console for debugging/advanced use
        window.roomDesigner = roomDesigner;
        
        // Add some initial furniture for demo
        setTimeout(() => {
            roomDesigner.addFurniture('sofa', 4, 2);
            roomDesigner.addFurniture('table', 3, 3);
            roomDesigner.addFurniture('chair', 1, 1);
            roomDesigner.cliOutput('Demo furniture added. Try moving them with mouse or arrow keys.');
        }, 500);
    </script>
</body>
</html>
