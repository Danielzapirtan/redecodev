<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>CLI Room Designer + Gemini Prompt Generator</title>
<style>
    body { 
        font-family: monospace; 
        display: flex; 
        margin: 0; 
        height: 100vh;
        background: #111;
        color: #0f0;
    }
    #left {
        width: 350px;
        padding: 10px;
        border-right: 2px solid #0f0;
        display: flex;
        flex-direction: column;
    }
    #terminal {
        flex: 1;
        background: black;
        padding: 10px;
        overflow-y: auto;
        border: 1px solid #0f0;
        white-space: pre-wrap;
    }
    #input {
        width: 100%;
        padding: 10px;
        border: none;
        border-top: 1px solid #0f0;
        background: #000;
        color: #0f0;
        font-family: monospace;
    }
    #canvas {
        flex: 1;
        background: #222;
    }
</style>
</head>
<body>

<div id="left">
    <div id="terminal"></div>
    <input id="input" placeholder="Type command (help)" autofocus />
</div>

<canvas id="canvas" width="900" height="800"></canvas>

<script>
// ----------------------------
// State
// ----------------------------
const terminal = document.getElementById("terminal");
const input = document.getElementById("input");
const canvas = document.getElementById("canvas");
const ctx = canvas.getContext("2d");

let furniture = [];
let room = { width: 900, height: 800 };

// ----------------------------
// CLI Output Helper
// ----------------------------
function log(msg) {
    terminal.textContent += msg + "\n";
    terminal.scrollTop = terminal.scrollHeight;
}

// ----------------------------
// Drawing
// ----------------------------
function draw() {
    ctx.fillStyle = "#222";
    ctx.fillRect(0, 0, canvas.width, canvas.height);

    // Draw furniture
    furniture.forEach(f => {
        ctx.fillStyle = f.color;
        ctx.fillRect(f.x, f.y, f.w, f.h);
        ctx.fillStyle = "#fff";
        ctx.fillText(f.name, f.x + 4, f.y + 14);
    });
}

// ----------------------------
// Commands
// ----------------------------
function execute(cmd) {
    const parts = cmd.trim().split(/\s+/);
    const c = parts[0];

    switch(c) {

        case "help":
            log(`Commands:
  add <name> <x> <y> <w> <h> <color>
  move <name> <dx> <dy>
  resize <name> <w> <h>
  delete <name>
  list
  clear
  prompt  → generate Gemini 3D prompt
  help`);
            break;

        case "add": {
            const [_, name, x, y, w, h, color="#44f"] = parts;
            if (!name || !x || !y || !w || !h) { log("Usage: add <name> <x> <y> <w> <h> <color>"); break; }
            furniture.push({
                name, 
                x: +x, y: +y, 
                w: +w, h: +h,
                color
            });
            log(`Added ${name}`);
            draw();
            break;
        }

        case "move": {
            const [_, name, dx, dy] = parts;
            const f = furniture.find(o => o.name === name);
            if (!f) { log("Furniture not found"); break; }
            f.x += +dx; f.y += +dy;
            log(`Moved ${name}`);
            draw();
            break;
        }

        case "resize": {
            const [_, name, w, h] = parts;
            const f = furniture.find(o => o.name === name);
            if (!f) { log("Furniture not found"); break; }
            f.w = +w; f.h = +h;
            log(`Resized ${name}`);
            draw();
            break;
        }

        case "delete": {
            const [_, name] = parts;
            furniture = furniture.filter(o => o.name !== name);
            log(`Deleted ${name}`);
            draw();
            break;
        }

        case "list":
            log("Furniture:");
            furniture.forEach(f => 
                log(`  ${f.name}: x=${f.x}, y=${f.y}, w=${f.w}, h=${f.h}, color=${f.color}`));
            break;

        case "clear":
            furniture = [];
            log("Cleared all furniture");
            draw();
            break;

        case "prompt":
            log("Generated Prompt:\n" + generateGeminiPrompt());
            break;

        default:
            log("Unknown command. Type 'help'");
    }
}

// ----------------------------
// Gemini Prompt Generation
// ----------------------------
function generateGeminiPrompt() {
    const items = furniture.map(f =>
        `${f.name}: positioned at (${f.x}, ${f.y}), size (${f.w}×${f.h})`
    ).join("; ");

return `
Create a photorealistic 3D interior render of a room with the following layout:

Room size: ${room.width} × ${room.height} cm (treat as proportions if scaled).

Furniture objects and positions (top-down coordinates, origin at top-left):
${items || "No furniture placed."}

Rendering requirements:
• Use realistic materials, global illumination, soft shadows.
• Furniture should match described positions precisely.
• Camera angle: 35–45° isometric perspective.
• High fidelity textures for walls, floor, and furniture.
• No people. No text. Non-interactive.

Output: A single photorealistic 3D render.
`.trim();
}

// ----------------------------
// CLI Input Handler
// ----------------------------
input.addEventListener("keydown", e => {
    if (e.key === "Enter") {
        const cmd = input.value;
        log("> " + cmd);
        execute(cmd);
        input.value = "";
    }
});

// Initial message
log("Room Designer CLI loaded. Type 'help'.");

draw();
</script>

</body>
</html>